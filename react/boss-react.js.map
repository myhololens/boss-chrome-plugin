{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./react/boss.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","BossApp","interval","breakCondition","paramToTransfer","Promise","resolve","setTimeout","wait","greetAnchor","config","city","skipCompany","maxAge","maxWorkAge","minWorkAge","minSalary","universityFilter","exp","getElementsByClassName","skipCompanyStr","JSON","parse","innerText","indexOf","nextElementSibling","university","reduce","childNodes","a","b","trim","nodeType","textContent","split","length","majorArray","passMajor","uniArray","passUni","labelText","currentAge","substr","workAge","currentSalarySpan","currentSalaryStr","currentSalary","jobIndex","jobRequest","XMLHttpRequest","onreadystatechange","readyState","DONE","status","ret","response","doc","document","createElement","innerHTML","html","dataset","jobid","open","send","chrome","storage","local","keyArray","forEach","item","geekUrl","getGeekHttpRequest","that","this","greet","closest","filterCv","push","greetElement","param","uid","jid","expect","lid","btnGreetHttpRequest","setRequestHeader","reject","rescode","_this","loadCity","then","loadConfig","message","getJob","_ref","_ref2","_slicedToArray","jobId","runtime","sendMessage","msg","totalPage","alert","promiseArray","getGeek","all","greetArray","concat","map","uidArray","uidCollection","communicate","querySelectorAll","values","classList","click","waiter","chatContainer","chatMessage","btnSend","mainList","getElementsByTagName","_loop","li","clickA","keys","err","console","log","finally","process"],"mappings":"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","file":"./react/boss-react.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 8);\n","class BossApp {\n\n    static message;\n    static city;\n\n    static waiter(interval, breakCondition, paramToTransfer) {\n        if (!interval) {\n            interval = 1000;\n        }\n        return new Promise(function (resolve) {\n            setTimeout(wait, 1000);\n\n            function wait() {\n                if (breakCondition()) {\n                    return resolve(paramToTransfer);\n                } else {\n                    setTimeout(wait, interval)\n                }\n            };\n        });\n    }\n\n\n    static filterCv(greetAnchor, config, city) {\n        let maxAge = config['max-age-' + city] || 100;\n        let maxWorkAge = config['max-exp-' + city] || 100;\n        let minWorkAge = config['min-exp-' + city] || 0;\n        let minSalary = config['min-salary-' + city] || 0;\n        let universityFilter = config['uni-filter-' + city];\n\n        //取到现在的公司\n        let exp = greetAnchor.getElementsByClassName('experience')[0];\n        let skipCompanyStr = config['company' + \"-\" + city];\n        let skipCompany;\n        if (skipCompanyStr) {\n            skipCompany = JSON.parse(skipCompanyStr);\n        }\n        if (exp && skipCompany) {\n            for (let c in skipCompany) {\n                if (exp.innerText.indexOf(skipCompany[c]) > -1) {\n                    return false;\n                }\n            }\n        }\n        if (universityFilter) {\n            if (exp.nextElementSibling) {\n                let university = [].reduce.call(exp.nextElementSibling.childNodes, function (a, b) {\n                    return a.trim() + (b.nodeType === 3 ? b.textContent : '');\n                }, '').split(\" \");\n                //包含了专业,university 例子：[\"西北大学\", \"软件工程\"]\n                if (university.length > 1) {\n                    let majorArray = ['计算机', '软件', '电子', '信息', '自动化', '通信', '控制'];\n                    let passMajor = false;\n                    for (let i = 0; i < majorArray.length; ++i) {\n                        if (university[1].indexOf(majorArray[i]) > -1) {\n                            passMajor = true;\n                            break;\n                        }\n                    }\n                    if (!passMajor) {\n                        return false;\n                    }\n                }\n                let uniArray = ['清华', '北大', '北航', '北京航空航天', '北京理工', '北京师范', '北京邮电', '中国人民大学'\n                    , '哈尔滨工业', '吉林大学', '东北大学', '东北师范', '大连理工', '西安交通大学', '西北工业', '湖南大学', '中南大学'\n                    , '西安电子科技', '电子科技', '四川大学', '重庆大学', '重庆邮电', '北京科技', '北京交通', '武汉大学', '华中科技', '武汉理工'\n                    , '复旦', '南开', '天津大学', '南京大学', '东南大学', '厦门大学', '中山大学', '华南理工', '浙江大学', '上海交通大学', '同济']\n                let passUni = false;\n                for (let i = 0; i < uniArray.length; ++i) {\n                    if (university[0].indexOf(uniArray[i]) > -1) {\n                        passUni = true;\n                        break;\n                    }\n                }\n                if (!passUni) {\n                    return false;\n                }\n            } else {\n                return false;\n            }\n        }\n\n\n        let labelText = greetAnchor.getElementsByClassName('label-text');\n        let currentAge = labelText[3].textContent.substr(0, labelText[3].textContent.length - 1);\n        let workAge = labelText[1].textContent.substr(0, labelText[1].textContent.length - 1);\n        //取到待遇\n        let currentSalarySpan = greetAnchor.getElementsByClassName('badge-salary')[0].textContent;\n        if (currentSalarySpan.indexOf(\"-\") == -1) {\n            return false;\n        }\n\n        let currentSalaryStr = currentSalarySpan.split(\"-\")[0];\n        let currentSalary = currentSalaryStr.substr(0, currentSalaryStr.length - 1);\n\n        return (!maxAge || maxAge >= currentAge) && (!minWorkAge || minWorkAge <= workAge)\n            && (!maxWorkAge || maxWorkAge >= workAge) && (!minSalary || currentSalary >= minSalary);\n\n    }\n\n\n    static getJob(config, city) {\n        let jobIndex = config['job-index-' + city];\n        let jobRequest = new XMLHttpRequest();\n        let url = 'https://www.zhipin.com/bossweb/joblist/data.json?' +\n            'page=1&type=0&status=0&_=1543980515163';\n        return new Promise((resolve => {\n            jobRequest.onreadystatechange = () => {\n                if (jobRequest.readyState == XMLHttpRequest.DONE\n                    && jobRequest.status == 200) {\n                    let ret = JSON.parse(jobRequest.response);\n                    let doc = document.createElement(\"div\");\n                    doc.innerHTML = ret.html;\n                    resolve([doc.getElementsByClassName('link-recommend')[jobIndex - 1].dataset.jobid\n                        , config]);\n                }\n            }\n            jobRequest.open(\"GET\", url, true);\n            jobRequest.send();\n        }));\n    }\n\n    static loadCity() {\n        return new Promise((resolve => {\n            chrome.storage.local.get(\"city\", resolve);\n        }));\n    }\n\n    static loadConfig(city) {\n        let keyArray = ['salary', 'experience', 'degree', 'max-age', 'min-exp', 'max-exp'\n            , 'min-salary', 'job-index', 'page-count', 'company', 'message', 'uni-filter'];\n        keyArray.forEach((item, i, t) => t[i] = item + \"-\" + city);\n        return new Promise((resolve => chrome.storage.local.get(keyArray, resolve)));\n    }\n\n    static getGeek(geekUrl, config, city) {\n        let getGeekHttpRequest = new XMLHttpRequest();\n        let that = this;\n        return new Promise((resolve => {\n            getGeekHttpRequest.onreadystatechange = function () {\n                if (getGeekHttpRequest.readyState == XMLHttpRequest.DONE\n                    && getGeekHttpRequest.status == 200) {\n                    let response = JSON.parse(getGeekHttpRequest.response);\n                    if (response[\"hasMore\"]) {\n                        let doc = document.createElement(\"div\");\n                        doc.innerHTML = response[\"htmlList\"];\n                        //取到所有的待打招呼的节点\n                        let greet = doc.getElementsByClassName('btn-greet');\n                        let ret = []\n                        for (let n = 0; n < greet.length; ++n) {\n                            let a = greet[n].closest('.sider-op').nextElementSibling;\n                            if (!that.filterCv(a, config, city)) {\n                                continue;\n                            }\n                            ret.push(a);\n                        }\n                        resolve(ret);\n                    } else {\n                        resolve([]);\n                    }\n                }\n            }\n            getGeekHttpRequest.open(\"GET\", geekUrl, true);\n            getGeekHttpRequest.send();\n        }));\n    }\n\n    static greet(greetElement) {\n        let btnGreetUrl = \"https://www.zhipin.com/chat/batchAddRelation.json\";\n        //记录下多少人成功的打招呼了\n        let param = 'gids=' + greetElement.dataset.uid + \"&jids=\" + greetElement.dataset.jid\n            + '&expectIds=' + greetElement.dataset.expect + \"&lids=\" + greetElement.dataset.lid;\n\n        let btnGreetHttpRequest = new XMLHttpRequest();\n        btnGreetHttpRequest.open(\"POST\", btnGreetUrl, false);\n        btnGreetHttpRequest.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');\n\n        return new Promise((resolve, reject) => {\n            btnGreetHttpRequest.onreadystatechange = () => {\n                if (btnGreetHttpRequest.readyState == XMLHttpRequest.DONE &&\n                    btnGreetHttpRequest.status == 200) {\n                    let btnGreetResponse = JSON.parse(btnGreetHttpRequest.response);\n                    if (btnGreetResponse.rescode == 1) {\n                        resolve(greetElement.dataset.uid);\n                    } else {\n                        reject(\"rescode not equal 1\")\n                    }\n                } else {\n                    reject(\"http error in greet\")\n                }\n            }\n            btnGreetHttpRequest.send(param);\n        })\n    }\n\n    static process() {\n        let that = this;\n        this.loadCity().then((ret) => {\n            this.city = ret.city || 0;\n            return this.loadConfig(this.city);\n        }).then((config) => {\n            this.message = config['message-' + this.city];\n            return this.getJob(config, this.city)\n        }).then(([jobId, config]) => {\n            chrome.runtime.sendMessage({\"msg\": \"获取职位完成\"});\n            let totalPage = config['page-count-' + this.city]\n            if (!totalPage) {\n                alert(\"没有设置候选人页数，默认是1\");\n                totalPage = 1;\n            }\n            let promiseArray = [];\n            let geekUrl = 'https://www.zhipin.com/boss/recommend/geeks.json?status=0&jobid=' + jobId\n                + '&salary=' + (config['salary' + \"-\" + this.city] || 0) + '&experience=' +\n                (config['experience' + \"-\" + this.city] || 0) +\n                '&degree=' + (config['degree' + \"-\" + this.city] || 0) + '&page=';\n\n            for (let m = 1; m <= totalPage; ++m) {\n                promiseArray.push(this.getGeek(geekUrl + m, config, this.city))\n            }\n            return Promise.all(promiseArray);\n        }).then((t) => {\n            chrome.runtime.sendMessage({\"msg\": \"获取候选人完成\"});\n            let greetArray = [];\n            for (let i = 0; i < t.length; ++i) {\n                if (t[i].length > 0) {\n                    greetArray = greetArray.concat(t[i]);\n                }\n            }\n            if (greetArray.length == 0) {\n                alert(\"没有合适的候选人了\");\n                return Promise.reject(\"empty\");\n            }\n\n            return greetArray;\n\n        }).then(\n            (greetArray) => {\n                let p = greetArray.map((value) => {\n                    return that.greet(value);\n                })\n                return Promise.all(p);\n            }\n        ).then((uidArray) => {\n            chrome.runtime.sendMessage({\"msg\": \"打招呼完成\"});\n            let uidCollection = {};\n            uidArray.forEach((value) => {\n                uidCollection[value] = 1;\n            });\n            let communicate = document.querySelectorAll(\"[ka='menu-im']\")[0];\n            if (Object.values(communicate.closest('.menu-chat').classList)\n                    .indexOf(\"cur\") == -1) {\n                communicate.click();\n            }\n            return this.waiter(1000, () => Object.values(communicate.closest('.menu-chat').classList)\n                .indexOf(\"cur\") > -1, uidCollection);\n        }).then((uidCollection) => {\n            let chatContainer = document.getElementsByClassName('chat-container')[0];\n            let chatMessage = chatContainer.getElementsByClassName('chat-message')[0];\n            let btnSend = chatContainer.getElementsByClassName('btn-send')[0];\n            let mainList = document.getElementsByClassName('main-list')[0]\n                .getElementsByTagName('li');\n\n            let p = Promise.resolve();\n\n            for (let i = 0; i < Object.keys(uidCollection).length; ++i) {\n                p = p.then(() => {\n                    let li = mainList[i];\n                    let clickA = li.getElementsByTagName('a')[0];\n                    if (uidCollection.hasOwnProperty(clickA.dataset.uid)) {\n                        delete uidCollection[clickA.dataset.uid];\n                        clickA.click();\n                        return this.waiter(1000, () => Object.values(li.classList).indexOf(\"cur\") > -1)\n                            .then(() => {\n                                    chatMessage.textContent = this.message;\n                                    btnSend.click();\n                                    return new Promise(resolve => {\n                                        setTimeout(resolve, 1000);\n                                    })\n                                }\n                            );\n                    }\n                    return Promise.resolve();\n                })\n            }\n            return p;\n        }).then(null, (err) => {\n            console.log(err);\n        }).finally(() => {\n            chrome.runtime.sendMessage({\"msg\": \"success\"});\n        });\n    }\n}\n\nBossApp.process();\n\n"],"sourceRoot":""}