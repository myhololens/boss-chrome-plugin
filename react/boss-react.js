!function(e){var t={};function n(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(r,a,function(t){return e[t]}.bind(null,a));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=8)}({8:function(e,t){function n(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,a=!1,i=void 0;try{for(var s,o=e[Symbol.iterator]();!(r=(s=o.next()).done)&&(n.push(s.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==o.return||o.return()}finally{if(a)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,a,i;return t=e,i=[{key:"waiter",value:function(e,t,n){return e||(e=1e3),new Promise(function(r){setTimeout(function a(){if(t())return r(n);setTimeout(a,e)},1e3)})}},{key:"filterCv",value:function(e,t,n){var r,a=t["max-age-"+n]||100,i=t["max-exp-"+n]||100,s=t["min-exp-"+n]||0,o=t["min-salary-"+n]||0,u=t["uni-filter-"+n],l=e.getElementsByClassName("experience")[0],c=t["company-"+n];if(c&&(r=JSON.parse(c)),l&&r)for(var f in r)if(l.innerText.indexOf(r[f])>-1)return!1;if(u){if(!l.nextElementSibling)return!1;var m=[].reduce.call(l.nextElementSibling.childNodes,function(e,t){return e.trim()+(3===t.nodeType?t.textContent:"")},"").split(" ");if(m.length>1){for(var d=["计算机","软件","电子","信息","自动化","通信","控制"],g=!1,p=0;p<d.length;++p)if(m[1].indexOf(d[p])>-1){g=!0;break}if(!g)return!1}for(var y=["清华","北大","北航","北京航空航天","北京理工","北京师范","北京邮电","中国人民大学","哈工大","中科院","中国科学院","哈尔滨工业","吉林大学","东北大学","东北师范","大连理工","西安交通大学","西北工业","湖南大学","中南大学","华科","武大","西安电子科技","电子科技","四川大学","重庆大学","重庆邮电","北京科技","北京交通","武汉大学","华中科技","武汉理工","复旦","南开","天津大学","南京大学","东南大学","厦门大学","中山大学","华南理工","浙江大学","上海交通大学","同济"],h=!1,v=0;v<y.length;++v)if(m[0].indexOf(y[v])>-1){h=!0;break}if(!h)return!1}var b=e.getElementsByClassName("label-text"),x=b[3].textContent.substr(0,b[3].textContent.length-1),w=b[1].textContent.substr(0,b[1].textContent.length-1),E=e.getElementsByClassName("badge-salary")[0].textContent;if(-1==E.indexOf("-"))return!1;var O=E.split("-")[0],j=O.substr(0,O.length-1);return parseInt(a)>=parseInt(x)&&parseInt(s)<=parseInt(w)&&parseInt(i)>=parseInt(w)&&parseInt(j)>=parseInt(o)}},{key:"getJob",value:function(e,t){var n=e["job-index-"+t],r=new XMLHttpRequest;return new Promise(function(t,a){r.onreadystatechange=function(){if(r.readyState===XMLHttpRequest.DONE)if(200==r.status){var i=JSON.parse(r.response),s=document.createElement("div");s.innerHTML=i.html,t([s.getElementsByClassName("link-recommend")[n-1].dataset.jobid,e])}else a("http status in get job")},r.onerror=function(){return a("http error in get job ")},r.open("GET","https://www.zhipin.com/bossweb/joblist/data.json?page=1&type=0&status=0&_=1543980515163",!0),r.send()})}},{key:"loadCity",value:function(){return new Promise(function(e){chrome.storage.local.get("city",e)})}},{key:"loadConfig",value:function(e){var t=["salary","experience","degree","max-age","min-exp","max-exp","min-salary","job-index","page-count","company","message","uni-filter"];return t.forEach(function(t,n,r){return r[n]=t+"-"+e}),new Promise(function(e){return chrome.storage.local.get(t,e)})}},{key:"getGeek",value:function(e,t,n){var r=new XMLHttpRequest,a=this;return new Promise(function(i){r.onreadystatechange=function(){if(r.readyState==XMLHttpRequest.DONE&&200==r.status){var e=JSON.parse(r.response);if(e.hasMore){var s=document.createElement("div");s.innerHTML=e.htmlList;for(var o=s.getElementsByClassName("btn-greet"),u=[],l=0;l<o.length;++l){var c=o[l].closest(".sider-op").nextElementSibling;a.filterCv(c,t,n)&&u.push(c)}i(u)}else i([])}},r.onerror=function(){return i([])},r.open("GET",e,!0),r.send()})}},{key:"greet",value:function(e){var t="gids="+e.dataset.uid+"&jids="+e.dataset.jid+"&expectIds="+e.dataset.expect+"&lids="+e.dataset.lid,n=new XMLHttpRequest;return n.open("POST","https://www.zhipin.com/chat/batchAddRelation.json",!1),n.setRequestHeader("Content-type","application/x-www-form-urlencoded"),new Promise(function(r,a){n.onreadystatechange=function(){n.readyState===XMLHttpRequest.DONE&&(200===n.status?1==JSON.parse(n.response).rescode?r(e.dataset.uid):a("rescode not equal 1"):a("http error in greet"))},n.onerror=function(){return a("http error in greet")},n.send(t)})}},{key:"process",value:function(){var e=this,t=this;this.loadCity().then(function(t){return e.city=t.city||0,e.loadConfig(e.city)}).then(function(t){return e.message=t["message-"+e.city],e.getJob(t,e.city)}).then(function(t){var r=n(t,2),a=r[0],i=r[1];chrome.runtime.sendMessage({msg:"获取职位完成"});var s=i["page-count-"+e.city];s||(alert("没有设置候选人页数，默认是1"),s=1);for(var o=[],u="https://www.zhipin.com/boss/recommend/geeks.json?status=0&jobid="+a+"&salary="+(i["salary-"+e.city]||0)+"&experience="+(i["experience-"+e.city]||0)+"&degree="+(i["degree-"+e.city]||0)+"&page=",l=1;l<=s;++l)o.push(e.getGeek(u+l,i,e.city));return Promise.all(o)}).then(function(e){chrome.runtime.sendMessage({msg:"获取候选人完成"});for(var t=[],n=0;n<e.length;++n)e[n].length>0&&(t=t.concat(e[n]));return 0===t.length?(alert("没有合适的候选人了"),Promise.reject("empty")):t}).then(function(e){var n=e.map(function(e){return t.greet(e)});return Promise.all(n)}).then(function(t){chrome.runtime.sendMessage({msg:"打招呼完成"});var n={};t.forEach(function(e){n[e]=1});var r,a=document.querySelectorAll("[ka='menu-im']")[0];return-1==Object.values(a.closest(".menu-chat").classList).indexOf("cur")&&a.click(),e.waiter(1e3,(r=void 0,function(){if(Object.values(a.closest(".menu-chat").classList).indexOf("cur")>-1){if(void 0===r)return r=document.getElementsByClassName("main-list")[0].getElementsByTagName("li")[0].getElementsByTagName("a")[0].dataset.uid,!1;var e=document.getElementsByClassName("main-list")[0].getElementsByTagName("li")[0].getElementsByTagName("a")[0].dataset.uid;return e===r||(r=e,!1)}return!1}),n)}).then(function(t){chrome.runtime.sendMessage({msg:"正在发送常用语..."});for(var n=document.getElementsByClassName("chat-container")[0],r=n.getElementsByClassName("chat-message")[0],a=n.getElementsByClassName("btn-send")[0],i=document.getElementsByClassName("main-list")[0].getElementsByTagName("li"),s=Promise.resolve(),o=function(n){s=s.then(function(){var s=i[n],o=s.getElementsByTagName("a")[0];return t.hasOwnProperty(o.dataset.uid)?(delete t[o.dataset.uid],o.click(),e.waiter(1e3,function(){return Object.values(s.classList).indexOf("cur")>-1}).then(function(){return r.textContent=e.message,a.click(),new Promise(function(e){setTimeout(e,1e3)})})):Promise.resolve()})},u=0;u<Object.keys(t).length;++u)o(u);return s}).then(null,function(e){console.log(e)}).finally(function(){chrome.runtime.sendMessage({msg:"success"})})}}],(a=null)&&r(t.prototype,a),i&&r(t,i),e}();a(i,"message",void 0),a(i,"city",void 0),i.process()}});
//# sourceMappingURL=boss-react.js.map